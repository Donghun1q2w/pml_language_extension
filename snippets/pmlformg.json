{
    "New PML Form Definition": {
        "prefix": "pmlformg",
        "body": [
            "-------------------------------------------------------------------------------",
            "--",
            "--",
            "-- Copyright $CURRENT_YEAR to current year. Company Name. All rights reserved.",
            "--",
            "--",
            "-- Other copyright Information goes here!",
            "--",
            "-- Author: First Last",
            "-- Date: \"$CURRENT_YEAR-$CURRENT_MONTH-$CURRENT_DATE\"",
            "-- Filename: \"$TM_FILENAME\"",
            "--",
            "-------------------------------------------------------------------------------",
            "",
            "",
            "import 'MarApi'",
            "handle (1000,0)",
            "endhandle",
            "",
            "import 'GridControl'",
            "handle (1000,0)",
            "endhandle",
            "",
            "import 'PMLFileBrowser'",
            "handle (1000,0)",
            "endhandle",
            "",
            "",
            "setup form !!${1} size 100 20 VarChars dialog resizable",
            "",
            "\tusing namespace 'Aveva.Pdms.Presentation'",
            "\t!this.formtitle = '${0}'",
            "",
            "",
            "\t!this.newMenu(|gridPopup|)",
            "\t!this.gridPopup.add('CALLBACK', 'Clear List', '!this.removeAll()')",
            "\t!this.gridPopup.add('CALLBACK', 'Remove Selected from List', '!this.removeSelected()')",
            "\t!this.gridPopup.add('CALLBACK', 'Export Results to Excel', '!this.ExportToExcel()')",
            "",
            "\tcontainer .GridFrame NOBOX PMLNetControl dock fill height 20 width 80",
            "",
            "\tmember .gridCtrl is NetGridControl",
            "",
            "",
            "exit",
            "",
            "",
            "------------------------------ CONSTRUCTOR METHOD -----------------------------",
            "define method .${1}()",
            "",
            "\tusing namespace 'Aveva.Pdms.Presentation'",
            "",
            "",
            "\t!this.GridCtrl = object NetGridControl()",
            "\t!this.GridCtrl.singleRowSelection(false)",
            "\t!this.GridCtrl.editableGrid(false)",
            "\t!this.GridCtrl.Updates(true)",
            "\t!this.GridCtrl.HideGroupByBox(false)",
            "\t!this.GridCtrl.outlookGroupStyle(true)",
            "\t!this.GridCtrl.clearGrid()",
            "\t!this.GridCtrl.columnExcelFilter(true)",
            "\t!this.GridFrame.Control = !this.GridCtrl.handle()",
            "\t!this.gridCtrl.addeventhandler('OnPopup', !this, 'rightClickGrid')",
            "",
            "endmethod",
            "",
            "",
            "--------------------------- RIGHT CLICK GRID METHOD ---------------------------",
            "define method .rightClickGrid(!data is array)",
            "",
            "\t!this.gridFrame.popup = !this.gridPopup",
            "\t!this.gridFrame.showPopup(!data[0], !data[1])",
            "endmethod",
            "",
            "",
            "----------------------------- REMOVE ALL FROM GRID ----------------------------",
            "define method .removeAll()",
            "",
            "\t!this.gridCtrl.cleargrid()",
            "",
            "endmethod",
            "",
            "",
            "-------------------------- REMOVE SELECTED FROM GRID --------------------------",
            "define method .removeSelected()",
            "",
            "\t!this.gridCtrl.deleteSelectedRows()",
            "",
            "\tif !this.gridCtrl.GetRows().Empty() then",
            "\t\t!this.gridCtrl.cleargrid()",
            "\tendif",
            "",
            "endmethod",
            "",
            "",
            "---------------------------- EXPORT GRID TO EXCEL ----------------------------",
            "define method .ExportToExcel()",
            "",
            "\tusing namespace 'Aveva.Pdms.Presentation'",
            "",
            "\t!ExportPath = |C:\\Temp|",
            "\t!FileName   = |${0}.xls|",
            "",
            "\t!browser    = object PMLFileBrowser('Save')",
            "\t!browser.show(!ExportPath, !FileName, 'Save results', false, 'Excel Files (*.xls)|*.xls', 1)",
            "\tif (!browser.file().eq('')) then",
            "\t\treturn",
            "\telse",
            "\t\t!this.gridCtrl.SaveGridToExcel(!browser.file())",
            "\tendif",
            "",
            "endmethod"


        ],
        "description": "Base for a new PML Form with pre-defined grid"
    }
}